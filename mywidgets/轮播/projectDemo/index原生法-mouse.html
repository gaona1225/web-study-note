<!doctype html>
<html>
<head>
<meta charset="utf-8">
<!--<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />-->
<title>index</title>
<style>
	body{
		font-family:"microsoft yahei" ;
		margin:0 ;
		overflow-x:hidden ;
		padding:0 ;
	}
	a{
		text-decoration:none ;
	}
	ul,li,dl,dd{
		list-style:none ;
		margin:0 ;
		padding:0 ;
	}
	header{
		background:#5e87b0 ;
		border:1px solid #456f9a ;
		background-image:-webkit-gradient(linear,left top,left bottom,from(#81a8ce),to(#5e87b0)) ;
		background-image:-webkit-linear-gradient(#81a8ce,#5e87b0) ;
		background-image:-moz-linear-gradient(#81a8ce,#5e87b0) ;
		background-image:-ms-linear-gradient(#81a8ce,#5e87b0) ;
		background-image:-o-linear-gradient(#81a8ce,#5e87b0) ;
		background-image:linear-gradient(#81a8ce,#5e87b0) ;
		
		color:#fff ;
		padding:8px 0 ;
		text-align:center ;
	}	
	header h1{
		display:inline-block ;
		font-size:24px ;
		font-weight:normal ;
		margin:0 ;
		padding:0 ;
	}	
	.graybtn{
		background:#eee ;
		border:1px solid #ccc ;
		border-radius:5px ;
		background-image:-webkit-gradient(linear,left top,left bottom,from(#fdfdfd),to(#eee)) ;
		background-image:-webkit-linear-gradient(#fdfdfd,#eee) ;
		background-image:-moz-linear-gradient(#fdfdfd,#eee) ;
		background-image:-ms-linear-gradient(#fdfdfd,#eee) ;
		background-image:-o-linear-gradient(#fdfdfd,#eee) ;
		background-image:linear-gradient(#fdfdfd,#eee) ;
		
		color:#444 ;
		padding:4px 8px ;
		text-shadow:0 1px 1px #f6f6f6 ;
	}
	.back_btn,.next_btn{
		display:inline-block ;
		position:absolute ;
		top:10px ;
	}
	.back_btn{
		left:4px ;
	}
	.next_btn{
		right:4px ;
	}
	nav{
		overflow:hidden ;
		padding:6px 0 0 0 ;
		position:relative ;
		width:100% ;
	}
	nav ul{
		border-bottom:1px solid #ccc ;
		height:29px ;
		width:1000px ;
	}
	nav li{
		float:left ;
		text-align:center ;
		width:50px ;
	}
	nav li a{
		color:#444 ;
		display:inline-block ;
		font-size:18px ;
		padding-bottom:6px ;
		position:relative ;
	}
	.arrow:before{
		border:10px solid #fff ;
		border-color:transparent transparent #81a8ce transparent ;
		border-width:6px 10px ;
		content:'' ;
		display:block ;
		height:0 ;
		left:6px ;
		margin-top:6px ;
		position:absolute ;
		top:12px ;
		width:0 ;
		z-index:9 ;
	}
	.arrow:after{
		border:10px solid #fff ;
		border-color:transparent transparent #fff transparent ;
		border-width:5px 9px ;
		content:'' ;
		display:block ;
		height:0 ;
		left:7px ;
		margin-top:6px ;
		position:absolute ;
		top:14px ;
		width:0 ;
		z-index:10 ;
	}
	.detail_list{
		width:100% ;
	}
	.detail_list dl{
		border-bottom:1px solid #ccc ;
		padding:10px 16px 10px 76px ;
		position:relative ;
	}
	.detail_list dd{
		display:block ;
		margin-bottom:6px ;
		position:relative ;
		right:0px ;
	}
	.detail_list dd.info-tx{
		left:6px ;
		position:absolute ;
	}
	.info-tx img{
		border-radius:10px ;
		height:60px ;
		width:60px ;
	}
	.info-tit{
		color:#ccc ;
		text-align:right ;
	}
	.info-tit a:link,.info-tit a:visited{
		color:#ccc ;
		float:left ;
	}
	.info-tit a:hover{
		color:#81a8ce ;
	}
	.detail{
		overflow:hidden ;
		width:100% ;
	}
	.detail_wrap{
		overflow:hidden ;
		position:absolute ;
	}
	.detail_list{
		float:left ;
	}
	.detail_list dd.info-new{
		background:red ;
		border-radius:20px ;
		height:20px ;
		position:absolute ;
		right:6px ;
		top:10px ;
		width:20px ;
	}
	@media all and (min-width:0px) and (max-width:320px){
		.detail_list dl{
			padding-left:36px ;
		}
		.info-tx img{
			height:24px ;
			width:24px ;
		}
	}
	
</style>
</head>

<body>
<header>
	<a href="#" class="graybtn back_btn">返回</a>
	<h1>百科问答</h1>
	<a href="#" class="graybtn next_btn">图标</a>
</header>
<nav>
    <ul id="nav">
        <li><a href="#" class="arrow">最新</a></li>
        <li><a href="#">精华</a></li>
        <li><a href="#">进攻</a></li>
        <li><a href="#">防守</a></li>
        <li><a href="#">阵型</a></li>
        <li><a href="#">其他</a></li>
        <li><a href="#">同城</a></li>
        <li><a href="#">女生</a></li>
    </ul>
</nav>
<div class="detail">
    <div class="detail_wrap">        
        <div class="detail_list">
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">赤炎の贵族</a>
                    <span>来自福州</span>
                    <span>今日12：30</span>
                </dd>
                <dd class="info-new"></dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">0个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">托尼托尼乔巴</a>
                    <span>来自火星</span>
                    <span>2013-12-10</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">5个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">赤炎の贵族</a>
                    <span>来自福州</span>
                    <span>今日12：30</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">0个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">托尼托尼乔巴</a>
                    <span>来自火星</span>
                    <span>2013-12-10</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">5个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">赤炎の贵族</a>
                    <span>来自福州</span>
                    <span>今日12：30</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">0个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">托尼托尼乔巴</a>
                    <span>来自火星</span>
                    <span>2013-12-10</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">5个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">赤炎の贵族</a>
                    <span>来自福州</span>
                    <span>今日12：30</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">0个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">托尼托尼乔巴</a>
                    <span>来自火星</span>
                    <span>2013-12-10</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">5个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">赤炎の贵族</a>
                    <span>来自福州</span>
                    <span>今日12：30</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">0个答案</dd>
            </dl>
            <dl>
                <dd class="info-tx">
                    <a href="#"><img src="img/tx.png" /></a>
                </dd>
                <dd class="info-tit">
                    <a href="#">托尼托尼乔巴</a>
                    <span>来自火星</span>
                    <span>2013-12-10</span>
                </dd>
                <dd class="info-mes">升了4本之后，应该注意什么，感觉金钱和水越来越难抢啊...</dd>
                <dd class="info-ans">5个答案</dd>
            </dl>
        </div>
        <div class="detail_list">
            22222
        </div>
        <div class="detail_list">
            33333
        </div>
        <div class="detail_list">
            44444
        </div>
        <div class="detail_list">
            55555
        </div>
        <div class="detail_list">
            66666
        </div>
        <div class="detail_list">
            77777
        </div>
        <div class="detail_list">
            88888
        </div>
    </div>
 </div>
<script language="javascript">
	window.onload = function(){
		var _wrapHei = window.innerHeight ;
		var _wrapWid = window.innerWidth ;
		//点击导航交互	
		var _nav = document.getElementById('nav') ;
		var _li = _nav.getElementsByTagName('li') ;
		var _len = _li.length ;
		var flagTouch = 0 ;
		for(var i=_len-1; i>=0; i--){
			_li[i].onclick = function(i){
				clearInterval(setInt) ;
				flagTouch = 0 ;
				var oldIndex = getIndex(document.getElementsByClassName('arrow')[0].parentNode) ;
				return function(){
					var changeIndex = getIndex(document.getElementsByClassName('arrow')[0].parentNode) ;
					for(var j=_len-1; j>=0; j--){
						if(i == j){
							addClass(_li[j].childNodes[0],'arrow') ;
						}else{
							removeClass(_li[j].childNodes[0],'arrow') ;
						}
					}
					if(changeIndex>i){
						moveX((changeIndex - i),Math.abs(i - oldIndex + 1)) ;
					}else if(changeIndex<i){
						moveX((changeIndex - i),Math.abs(oldIndex - i + 1)) ;
					}
				}
			}(i)
		}
		
		setWAH() ;
		function setWAH(){
			var _wrapHei = window.innerHeight ;
			var _wrapWid = window.innerWidth ;
			for(var i=_len-1; i>=0; i--){
				document.getElementsByClassName('detail_list')[i].style.width = _wrapWid + 'px' ;
				document.getElementsByClassName('detail_list')[i].style.height = _wrapHei + 'px' ;
			}
			document.getElementsByClassName('detail')[0].style.height = _wrapHei + 'px' ;
			document.getElementsByClassName('detail_wrap')[0].style.height = _wrapHei + 'px' ;
			document.getElementsByClassName('detail_wrap')[0].style.width = parseInt(_wrapWid * _len) + 'px' ;			
		}
		
		window.onresize = function(){
			setWAH() ;
		}
		
		//滚动滚动条交互
		window.onscroll = function(){
			var _conHei = document.body.offsetHeight ;
			var _scrTop = document.body.scrollTop ;
			if(_scrTop + _wrapHei >= _conHei){
				console.log('到底了，向下加载数据...') ;
			}else if(_scrTop == 0){
				console.log('到顶了，向上加载数据...') ;
			}
		}
		
		//滑动内容交互
		var _liWid = parseInt(_li[0].offsetWidth) ;
		_nav.style.width = _liWid * _len + 'px' ;
		var _detail_list = document.getElementsByClassName('detail_wrap')[0] ;
		var _detailWid = parseInt(document.getElementsByClassName('detail_list')[0].offsetWidth) ;
		var beginX, count, minX = 20,diffX,setInt,setInt2,count=0,beginLeft; //minX最少滑动的距离触发切换一屏
		
		_detail_list.addEventListener('mousedown',touchStart,false) ;
		function touchStart(e){
			e.preventDefault() ;
			touchLi(e) ;
		}
		
		function touchLi(e){
			e.preventDefault();
			flagTouch = 1 ; //当用户连续滑动，只做一次处理。用户手指没有弹起脱离触摸屏做一次处理
			beginX = e.clientX ;
			beginLeft = parseInt(getStyle(_detail_list,'marginLeft')) ;
			_detail_list.addEventListener('mousemove',touchMove,false) ;
			_detail_list.addEventListener('mouseup',touchEnd,false) ;
		}
		
		function touchMove(e){
			e.preventDefault();
			diffX = e.clientX - beginX ;
			//TODO 吸附式拖动算法实现	
			clearInterval(setInt) ;		
			if(flagTouch){
				var _arrow = document.getElementsByClassName('arrow')[0] ;
				if(_arrow.parentNode){
					var countCur = getIndex(_arrow.parentNode) ;
				}
				if(diffX>0 && countCur>0){
					var _detailLeft = parseInt(getStyle(_detail_list,'marginLeft')) ;
					_detailLeft ++ ;
					_detail_list.style.marginLeft = _detailLeft + 'px' ;
				}else if(countCur<_len-1 && diffX<0){
					var _detailLeft = parseInt(getStyle(_detail_list,'marginLeft')) ;
					_detailLeft -- ;
					_detail_list.style.marginLeft = _detailLeft + 'px' ;
				}
			}			
		}
		
		function touchEnd(e){
			if(flagTouch){
				var _arrow = document.getElementsByClassName('arrow')[0] ;
				if(_arrow.parentNode){
					count = getIndex(_arrow.parentNode) ;
				}
				if(Math.abs(diffX)>minX){
					moveX(diffX,count) ;
				}else{
					_detail_list.style.marginLeft = beginLeft + 'px' ; //滑动弧度小于设置的最小间距时重置move过程中的拖到效果
				}
			}
			flagTouch = 0 ;
		}
		
		//滑动弧度大于设置的最小间距时move算法
		function moveX(numX,count){
			if(numX>0){
				if(count>0){
					count -- ;
					var _left = parseInt(getStyle(_nav,'marginLeft')) ;
					var _detailLeft = parseInt(getStyle(_detail_list,'marginLeft')) ;
					setInt = setInterval(function(){
						if(_left<=-(count*_liWid)){
							_left ++ ;
							_nav.style.marginLeft = _left + 'px' ;
						}else{
							clearInterval(setInt) ;
						}
					}) ;
					setInt2 = setInterval(function(){		
						if(_detailLeft<=-(count*_detailWid)){
							_detailLeft ++ ;
							_detail_list.style.marginLeft = _detailLeft + 'px' ;
						}else{
							clearInterval(setInt2) ;
						}
					}) ;
				}
			}else{
				var maxLen = Math.abs(Math.floor(parseInt(document.getElementsByTagName('nav')[0].offsetWidth - _nav.offsetWidth)/_liWid)) ; 
				if(count<_len-1){
					count ++ ;
					var _left = parseInt(getStyle(_nav,'marginLeft')) ;
					var _detailLeft = parseInt(getStyle(_detail_list,'marginLeft')) ;
					if(count<=maxLen){ //当达到maxLen值时 导航不需要滑动，即如果能在一屏显示剩余的所有导航菜单，则不需要再滑动了
						setInt = setInterval(function(){
							if(_left>=-(count*_liWid)){
								_left -- ;
								_nav.style.marginLeft = _left + 'px' ;
							}else{
								clearInterval(setInt) ;
							}
						}) ;
					}
					setInt2 = setInterval(function(){
						if(_detailLeft>=-(count*_detailWid)){
							_detailLeft -- ;
							_detail_list.style.marginLeft = _detailLeft + 'px' ;
						}else{
							clearInterval(setInt2) ;
						}
					}) ;
				}
			}
			for(var i=_len-1; i>=0; i--){
				if(count == i){
					addClass(_li[i].childNodes[0],'arrow') ;
				}else{
					removeClass(_li[i].childNodes[0],'arrow') ;
				}
			}
		}
	}
	
	//添加class名
	function addClass(obj,newClass){
		var _oldClass = obj.className ;
		if(_oldClass == ''){
			obj.className = newClass
		}else if(obj.className.indexOf(newClass) == -1){
			obj.className = _oldClass + ' ' + newClass ;
		}
	}
	//删除class名
	function removeClass(obj,delClass){
		var _oldClass = obj.className ;
		if(_oldClass.indexOf(delClass)>-1){
			obj.className = _oldClass.replace(delClass,'') ;
		}
	}
	//获取css中样式值方法
	function getStyle(obj,cssName){
		if(obj.currentStyle){
			return obj.currentStyle[cssName] ;
		}else{
			return getComputedStyle(obj,false)[cssName] ;
		}
	}
	//获取对象的索引值
	function getIndex(obj){
		var aAry = [] ;
		var preObj = obj.previousSibling ;
		while(preObj){
			if(preObj.nodeType === 1){
				aAry.push(preObj) ;
			}
			preObj = preObj.previousSibling ;
		}
		return aAry.length ;
	}
</script>
</body>
</html>
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>geolocation-watchPosition</title>
<script language="javascript" src="phonegap-1.3.0.js"></script>
<script language="javascript">
	// 等待加载PhoneGap
	document.addEventListener("deviceready", onDeviceReady, false); 
	
	var watchID = null;
	
	// PhoneGap加载完毕
	function onDeviceReady() {
		// 每隔3秒钟更新一次
		var options = { frequency: 3000 };
		watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
	}
	
	// 获取位置信息成功时调用的回调函数
	function onSuccess(position) {
		var element = document.getElementById('geolocation');
		element.innerHTML = 'Latitude: '  + position.coords.latitude      + '<br />' +
							'Longitude: ' + position.coords.longitude     + '<br />' +
							'<hr />'      + element.innerHTML;
	}
	
	// 清除前述已经开始的监视
	function clearWatch() {
		if (watchID != null) {
			navigator.geolocation.clearWatch(watchID);
			watchID = null;
		}
	}
	
	// onError回调函数接收一个PositionError对象
	function onError(error) {
		alert('code: '    + error.code    + '\n' +
			'message: ' + error.message + '\n');
	}
</script>
</head>

<body>
	<p id="geolocation">Finding geolocation...</p>
    <button onclick="clearWatch();">Clear Watch</button>
</body>
</html>
